{"ast":null,"code":"import { LOGIN_URL, REGISTER_URL, REQUEST_PASSWORD_URL } from '../redux/AuthCRUD';\nimport { UsersTableMock } from './usersTableMock';\nexport function mockAuth(mock) {\n  console.log(mock);\n  mock.onPost(LOGIN_URL).reply(({\n    data\n  }) => {\n    const {\n      email,\n      password\n    } = JSON.parse(data);\n    /* if (email && password) {\r\n      const user = UsersTableMock.table.find(\r\n        (x) => x.email.toLowerCase() === email.toLowerCase() && x.password === password\r\n      )\r\n        if (user) {\r\n        const auth = user.auth\r\n        return [200, {...auth, password: undefined}]\r\n      }\r\n    }\r\n      return [400] */\n  });\n  mock.onPost(REGISTER_URL).reply(({\n    data\n  }) => {\n    const {\n      email,\n      firstname,\n      lastname,\n      password\n    } = JSON.parse(data);\n\n    if (email && firstname && lastname && password) {\n      const user = {\n        id: generateUserId(),\n        email,\n        firstname,\n        lastname,\n        username: `${firstname}-${lastname}`,\n        password,\n        roles: [2],\n        // Manager\n        auth: {\n          accessToken: 'access-token-' + Math.random(),\n          refreshToken: 'access-token-' + Math.random()\n        },\n        pic: process.env.PUBLIC_URL + '/media/users/default.jpg'\n      };\n      UsersTableMock.table.push(user);\n      const auth = user.auth;\n      return [200, { ...auth,\n        password: undefined\n      }];\n    }\n\n    return [400];\n  });\n  mock.onPost(REQUEST_PASSWORD_URL).reply(({\n    data\n  }) => {\n    const {\n      email\n    } = JSON.parse(data);\n\n    if (email) {\n      const user = UsersTableMock.table.find(x => x.email.toLowerCase() === email.toLowerCase());\n      let result = false;\n\n      if (user) {\n        user.password = undefined;\n        result = true;\n        return [200, {\n          result,\n          password: undefined\n        }];\n      }\n    }\n\n    return [400];\n  });\n  /*   mock.onGet(GET_USER_BY_ACCESSTOKEN_URL).reply(({headers: {Authorization}}) => {\r\n    const accessToken =\r\n      Authorization && Authorization.startsWith('Bearer ') && Authorization.slice('Bearer '.length)\r\n      if (accessToken) {\r\n      const user = UsersTableMock.table.find((x) => x.auth?.accessToken === accessToken)\r\n        if (user) {\r\n        return [200, {...user, password: undefined}]\r\n      }\r\n    }\r\n      return [401]\r\n  }) */\n\n  function generateUserId() {\n    const ids = UsersTableMock.table.map(el => el.id);\n    const maxId = Math.max(...ids);\n    return maxId + 1;\n  }\n}","map":{"version":3,"sources":["/Users/joseluis/Desarrollos/Template/MetronicReact1/src/app/modules/auth/__mocks__/mockAuth.ts"],"names":["LOGIN_URL","REGISTER_URL","REQUEST_PASSWORD_URL","UsersTableMock","mockAuth","mock","console","log","onPost","reply","data","email","password","JSON","parse","firstname","lastname","user","id","generateUserId","username","roles","auth","accessToken","Math","random","refreshToken","pic","process","env","PUBLIC_URL","table","push","undefined","find","x","toLowerCase","result","ids","map","el","maxId","max"],"mappings":"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","sourcesContent":["import MockAdapter from 'axios-mock-adapter'\r\nimport {UserModel} from '../models/UserModel'\r\nimport {\r\n  LOGIN_URL,\r\n  GET_USER_BY_ACCESSTOKEN_URL,\r\n  REGISTER_URL,\r\n  REQUEST_PASSWORD_URL,\r\n} from '../redux/AuthCRUD'\r\nimport {UsersTableMock} from './usersTableMock'\r\n\r\nexport function mockAuth(mock: MockAdapter) {\r\n  console.log(mock)\r\n  mock.onPost(LOGIN_URL).reply(({data}) => {\r\n    const {email, password} = JSON.parse(data)\r\n\r\n    /* if (email && password) {\r\n      const user = UsersTableMock.table.find(\r\n        (x) => x.email.toLowerCase() === email.toLowerCase() && x.password === password\r\n      )\r\n\r\n      if (user) {\r\n        const auth = user.auth\r\n        return [200, {...auth, password: undefined}]\r\n      }\r\n    }\r\n\r\n    return [400] */\r\n  })\r\n\r\n  mock.onPost(REGISTER_URL).reply(({data}) => {\r\n    const {email, firstname, lastname, password} = JSON.parse(data)\r\n\r\n    if (email && firstname && lastname && password) {\r\n      const user: UserModel = {\r\n        id: generateUserId(),\r\n        email,\r\n        firstname,\r\n        lastname,\r\n        username: `${firstname}-${lastname}`,\r\n        password,\r\n        roles: [2], // Manager\r\n        auth: {\r\n          accessToken: 'access-token-' + Math.random(),\r\n          refreshToken: 'access-token-' + Math.random(),\r\n        },\r\n        pic: process.env.PUBLIC_URL + '/media/users/default.jpg',\r\n      }\r\n\r\n      UsersTableMock.table.push(user)\r\n      const auth = user.auth\r\n\r\n      return [200, {...auth, password: undefined}]\r\n    }\r\n\r\n    return [400]\r\n  })\r\n\r\n  mock.onPost(REQUEST_PASSWORD_URL).reply(({data}) => {\r\n    const {email} = JSON.parse(data)\r\n\r\n    if (email) {\r\n      const user = UsersTableMock.table.find((x) => x.email.toLowerCase() === email.toLowerCase())\r\n      let result = false\r\n      if (user) {\r\n        user.password = undefined\r\n        result = true\r\n        return [200, {result, password: undefined}]\r\n      }\r\n    }\r\n\r\n    return [400]\r\n  })\r\n\r\n  /*   mock.onGet(GET_USER_BY_ACCESSTOKEN_URL).reply(({headers: {Authorization}}) => {\r\n    const accessToken =\r\n      Authorization && Authorization.startsWith('Bearer ') && Authorization.slice('Bearer '.length)\r\n\r\n    if (accessToken) {\r\n      const user = UsersTableMock.table.find((x) => x.auth?.accessToken === accessToken)\r\n\r\n      if (user) {\r\n        return [200, {...user, password: undefined}]\r\n      }\r\n    }\r\n\r\n    return [401]\r\n  }) */\r\n\r\n  function generateUserId(): number {\r\n    const ids = UsersTableMock.table.map((el) => el.id)\r\n    const maxId = Math.max(...ids)\r\n    return maxId + 1\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}